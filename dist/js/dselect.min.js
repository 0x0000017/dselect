function dselectUpdate(e,s,a){const r=e.dataset.dselectValue,l=e.closest(`.${s}`).previousElementSibling,f=l.nextElementSibling.getElementsByClassName(a)[0],i=l.nextElementSibling.querySelector("input");l.multiple?Array.from(l.options).filter(m=>m.value===r)[0].selected=!0:l.value=r,l.multiple&&f.click(),l.dispatchEvent(new Event("change")),f.focus(),i&&(i.value="")}function dselectRemoveTag(e,s,a){const r=e.parentNode.dataset.dselectValue,l=e.closest(`.${s}`).previousElementSibling,f=l.nextElementSibling.getElementsByClassName(a)[0],i=l.nextElementSibling.querySelector("input");Array.from(l.options).filter(m=>m.value===r)[0].selected=!1,l.dispatchEvent(new Event("change")),f.click(),i&&(i.value="")}function dselectSearch(e,s,a,r,l){const f=s.value.toLowerCase().trim(),i=s.nextElementSibling,m=i.querySelectorAll(".dropdown-header"),x=i.querySelectorAll(".dropdown-item"),h=i.nextElementSibling;m.forEach(c=>c.classList.add("d-none"));for(const c of x)if(c.textContent.toLowerCase().indexOf(f)>-1){c.classList.remove("d-none");let g=c;for(;g=g.previousElementSibling;)if(g.classList.contains("dropdown-header")){g.classList.remove("d-none");break}}else c.classList.add("d-none");if(Array.from(x).filter(c=>!c.classList.contains("d-none")&&!c.hasAttribute("hidden")).length<1){if(h.classList.remove("d-none"),i.classList.add("d-none"),l&&(h.innerHTML=`Press Enter to add "<strong>${s.value}</strong>"`,e.key==="Enter")){const c=s.closest(`.${a}`).previousElementSibling,p=c.nextElementSibling.getElementsByClassName(r)[0];c.insertAdjacentHTML("afterbegin",`<option value="${s.value}" selected>${s.value}</option>`),c.dispatchEvent(new Event("change")),s.value="",s.dispatchEvent(new Event("keyup")),p.click(),p.focus()}}else h.classList.add("d-none"),i.classList.remove("d-none")}function dselectClear(e,s){const a=e.closest(`.${s}`).previousElementSibling;Array.from(a.options).forEach(r=>r.selected=!1),a.dispatchEvent(new Event("change"))}function dselect(e,s={}){e.style.display="none";const a="dselect-wrapper",r="dselect-no-results",l="dselect-tag",f="dselect-tag-remove",i="dselect-placeholder",m="dselect-clear",x="dselect-clearable",h=!1,S=!1,c=!1,p="360px",g="",k=w("search")||s.search||h,M=w("creatable")||s.creatable||S,y=w("clearable")||s.clearable||c,H=e.dataset.dselectMaxHeight||s.maxHeight||p;let E=e.dataset.dselectSize||s.size||g;E=E!==""?` form-select-${E}`:"";const b=`form-select${E}`,B=k?`<input onkeydown="return event.key !== 'Enter'" onkeyup="dselectSearch(event, this, '${a}', '${b}', ${M})" type="text" class="form-control" placeholder="Search" autofocus>`:"";function w(n){const o=`data-dselect-${n}`;return e.hasAttribute(o)?e.getAttribute(o).toLowerCase()==="true":null}function z(){e.nextElementSibling&&e.nextElementSibling.classList&&e.nextElementSibling.classList.contains(a)&&e.nextElementSibling.remove()}function $(n){return n.getAttribute("value")===""}function L(n,o){if(o){const t=Array.from(n).filter(d=>d.selected&&!$(d)),v=Array.from(n).filter(d=>$(d));let u=[];if(t.length===0){const d=v.length?v[0].textContent:"&nbsp;";u.push(`<span class="${i}">${d}</span>`)}else for(const d of t)u.push(`
            <div class="${l}" data-dselect-value="${d.value}">
              ${d.text}
              <svg onclick="dselectRemoveTag(this, '${a}', '${b}')" class="${f}" width="14" height="14" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M0 0h24v24H0z" fill="none"/><path d="M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2zm5 13.59L15.59 17 12 13.41 8.41 17 7 15.59 10.59 12 7 8.41 8.41 7 12 10.59 15.59 7 17 8.41 13.41 12 17 15.59z"/></svg>
            </div>
          `);return u.join("")}else{const t=n[n.selectedIndex];return $(t)?`<span class="${i}">${t.innerHTML}</span>`:t.innerHTML}}function C(n){const o=n[n.selectedIndex];return $(o)?"":o.textContent}function A(n){let o=[];for(const t of n)if(t.tagName==="OPTGROUP")o.push(`<h6 class="dropdown-header">${t.getAttribute("label")}</h6>`);else{const v=$(t)?" hidden":"",u=t.selected?" active":"",T=t.disabled||t.dataset.dselectDisabled==="true"||e.multiple&&t.selected,q=T?" disabled":"",D=T?"":` onclick="dselectUpdate(this, '${a}', '${b}')"`,P=t.value,R=t.textContent;o.push(`<button${v} class="dropdown-item${u}" data-dselect-value="${P}" type="button"${D}${q}>${R}</button>`)}return o.join("")}function N(){const n=e.multiple?' data-bs-auto-close="outside"':"",o=Array.from(e.classList).filter(u=>u!=="form-select"&&u!=="form-select-sm"&&u!=="form-select-lg").join(" "),t=y&&!e.multiple?`
    <button type="button" class="btn ${m}" title="Clear selection" onclick="dselectClear(this, '${a}')">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 14 14" fill="none">
        <path d="M13 1L0.999999 13" stroke-width="2" stroke="currentColor"></path>
        <path d="M1 1L13 13" stroke-width="2" stroke="currentColor"></path>
      </svg>
    </button>
    `:"",v=`
    <div class="dropdown ${a} ${o}">
      <button class="${b} ${!e.multiple&&y?x:""}" data-dselect-text="${!e.multiple&&C(e.options)}" type="button" data-bs-toggle="dropdown" aria-expanded="false"${n}>
        ${L(e.options,e.multiple)}
      </button>
      <div class="dropdown-menu">
        <div class="d-flex flex-column">
          ${B}
          <div class="dselect-items" style="max-height:${H};overflow:auto">
            ${A(e.querySelectorAll("*"))}
          </div>
          <div class="${r} d-none">No results found</div>
        </div>
      </div>
      ${t}
    </div>
    `;z(),e.insertAdjacentHTML("afterend",v)}N();function O(){const n=e.nextElementSibling,o=n.getElementsByClassName(b)[0],t=n.getElementsByClassName("dselect-items")[0];o.innerHTML=L(e.options,e.multiple),t.innerHTML=A(e.querySelectorAll("*")),e.multiple||(o.dataset.dselectText=C(e.options))}e.addEventListener("change",O)}
